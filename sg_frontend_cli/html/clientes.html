<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Clientes</title>
    <link rel="stylesheet" href="styles.css">
    <script src="clientes.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
  </head>
  <body onload="cargarClientes();">
    <div class="menu">
        <button onclick="window.location.href='clientes.html'">Clientes</button>
        <button onclick="window.location.href='facturas.html'">Facturas</button>
        <button onclick="window.location.href='cobradores.html'">Cobradores</button>
        <button onclick="window.location.href='contactabilidad.html'">Contactabilidad</button>
    </div>
    <h1>Clientes</h1>
    <p><button id="add-client-button" onclick="showModal()">Agregar cliente</button></p>

    <input type="text" id="search-clients" placeholder="Buscar..." onkeyup="doSearch()" />
    <table id="client-table">
      <thead>
        <tr>
          <th>ID Cliente</th>
          <th>Nombre y Apellido</th>
          <th>Teléfono</th>
          <th>Dirección</th>
          <th>Correo Electrónico</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody id="client-list">
      </tbody>
    </table>

    <div id="snackbar">Cliente actualizado con éxito</div>
    <div id="snackbarError">Hubo un problema al actualizar el registro</div>

    <!--Modal para agregar o editar un cliente-->
    <div id="client-modal" class="modal">
      <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <h2 id="modal-title">Agregar cliente</h2>
        <form id="client-form">
          <label for="id-client-input">ID Cliente</label>
          <input type="text" id="id-client-input" name="id-client-input" maxlength="06" required>

          <label for="name-input">Nombre y Apellido</label>
          <input type="text" id="name-input" name="name-input" maxlength="30" required>

          <label for="phone-input">Teléfono</label>
          <input type="text" id="phone-input" name="phone-input"  maxlength="15" required>

          <label for="address-input">Dirección</label>
          <input type="text" id="address-input" name="address-input" maxlength="30" required>

          <label for="email-input">Correo Electrónico</label>
          <input type="text" id="email-input" name="email-input" maxlength="30" required>

          <p></p>

          <button id="cancel-client-button" onclick="closeModal()">Cancelar</button>
          <button id="save-button" onclick="agregarCliente()" >Guardar</button>
          
        </form>
      </div>
    </div>
    <script>
      $(document).ready(function(){
        $("div[contenteditable='true'][maxlength]").on('keyup paste', function (event) {
        var cntMaxLength = parseInt($(this).attr('maxlength'));
        if ($(this).text().length >= cntMaxLength && event.keyCode != 8 && 
                                     event.keyCode != 37 && event.keyCode != 38 && event.keyCode != 39 && 
                                     event.keyCode != 40) {
          event.preventDefault();
          $(this).html(function(i, currentHtml) {
             return currentHtml.substring(0, cntMaxLength-1);
          });
        }
        });
      });
    </script>
  </body>
</html>


